Nutrients - kMeans clusters
================

<table class=" lightable-classic" style="font-family: &quot;Arial Narrow&quot;, &quot;Source Sans Pro&quot;, sans-serif; width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
Number of sampling events
</caption>
<thead>
<tr>
<th style="text-align:left;">
parameter
</th>
<th style="text-align:right;">
sea-HDR
</th>
<th style="text-align:right;">
sea-IND
</th>
<th style="text-align:right;">
pos-COM
</th>
<th style="text-align:right;">
sea-COM
</th>
<th style="text-align:right;">
tac-COM
</th>
<th style="text-align:right;">
sno-LDR
</th>
<th style="text-align:right;">
king-LDR
</th>
<th style="text-align:right;">
sno-HDR
</th>
<th style="text-align:right;">
tac-IND
</th>
<th style="text-align:right;">
king-COM
</th>
<th style="text-align:right;">
pot-COM
</th>
<th style="text-align:right;">
sno-COM
</th>
<th style="text-align:right;">
tac-HDR
</th>
<th style="text-align:right;">
king-HDR
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Total Suspended Solids.Total
</td>
<td style="text-align:right;">
34
</td>
<td style="text-align:right;">
32
</td>
<td style="text-align:right;">
49
</td>
<td style="text-align:right;">
32
</td>
<td style="text-align:right;">
38
</td>
<td style="text-align:right;">
40
</td>
<td style="text-align:right;">
30
</td>
<td style="text-align:right;">
33
</td>
<td style="text-align:right;">
30
</td>
<td style="text-align:right;">
31
</td>
<td style="text-align:right;">
33
</td>
<td style="text-align:right;">
32
</td>
<td style="text-align:right;">
48
</td>
<td style="text-align:right;">
21
</td>
</tr>
<tr>
<td style="text-align:left;">
Nitrite-Nitrate.Dissolved
</td>
<td style="text-align:right;">
34
</td>
<td style="text-align:right;">
32
</td>
<td style="text-align:right;">
43
</td>
<td style="text-align:right;">
32
</td>
<td style="text-align:right;">
24
</td>
<td style="text-align:right;">
46
</td>
<td style="text-align:right;">
30
</td>
<td style="text-align:right;">
37
</td>
<td style="text-align:right;">
20
</td>
<td style="text-align:right;">
31
</td>
<td style="text-align:right;">
31
</td>
<td style="text-align:right;">
38
</td>
<td style="text-align:right;">
42
</td>
<td style="text-align:right;">
21
</td>
</tr>
<tr>
<td style="text-align:left;">
Chloride.Total
</td>
<td style="text-align:right;">
34
</td>
<td style="text-align:right;">
32
</td>
<td style="text-align:right;">
49
</td>
<td style="text-align:right;">
33
</td>
<td style="text-align:right;">
23
</td>
<td style="text-align:right;">
45
</td>
<td style="text-align:right;">
28
</td>
<td style="text-align:right;">
37
</td>
<td style="text-align:right;">
18
</td>
<td style="text-align:right;">
31
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
37
</td>
<td style="text-align:right;">
35
</td>
<td style="text-align:right;">
20
</td>
</tr>
<tr>
<td style="text-align:left;">
Conductivity.Total
</td>
<td style="text-align:right;">
34
</td>
<td style="text-align:right;">
32
</td>
<td style="text-align:right;">
49
</td>
<td style="text-align:right;">
32
</td>
<td style="text-align:right;">
42
</td>
<td style="text-align:right;">
46
</td>
<td style="text-align:right;">
30
</td>
<td style="text-align:right;">
37
</td>
<td style="text-align:right;">
34
</td>
<td style="text-align:right;">
31
</td>
<td style="text-align:right;">
32
</td>
<td style="text-align:right;">
39
</td>
<td style="text-align:right;">
52
</td>
<td style="text-align:right;">
21
</td>
</tr>
<tr>
<td style="text-align:left;">
Total Kjeldahl Nitrogen.Total
</td>
<td style="text-align:right;">
34
</td>
<td style="text-align:right;">
32
</td>
<td style="text-align:right;">
48
</td>
<td style="text-align:right;">
32
</td>
<td style="text-align:right;">
25
</td>
<td style="text-align:right;">
44
</td>
<td style="text-align:right;">
30
</td>
<td style="text-align:right;">
34
</td>
<td style="text-align:right;">
21
</td>
<td style="text-align:right;">
31
</td>
<td style="text-align:right;">
30
</td>
<td style="text-align:right;">
34
</td>
<td style="text-align:right;">
42
</td>
<td style="text-align:right;">
21
</td>
</tr>
<tr>
<td style="text-align:left;">
Hardness as CaCO3.Total
</td>
<td style="text-align:right;">
34
</td>
<td style="text-align:right;">
32
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
33
</td>
<td style="text-align:right;">
42
</td>
<td style="text-align:right;">
46
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
38
</td>
<td style="text-align:right;">
33
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
39
</td>
<td style="text-align:right;">
52
</td>
<td style="text-align:right;">
NA
</td>
</tr>
<tr>
<td style="text-align:left;">
Total Phosphorus.Total
</td>
<td style="text-align:right;">
34
</td>
<td style="text-align:right;">
32
</td>
<td style="text-align:right;">
48
</td>
<td style="text-align:right;">
32
</td>
<td style="text-align:right;">
22
</td>
<td style="text-align:right;">
46
</td>
<td style="text-align:right;">
29
</td>
<td style="text-align:right;">
37
</td>
<td style="text-align:right;">
19
</td>
<td style="text-align:right;">
31
</td>
<td style="text-align:right;">
29
</td>
<td style="text-align:right;">
39
</td>
<td style="text-align:right;">
40
</td>
<td style="text-align:right;">
21
</td>
</tr>
<tr>
<td style="text-align:left;">
Ortho-phosphate.Dissolved
</td>
<td style="text-align:right;">
34
</td>
<td style="text-align:right;">
32
</td>
<td style="text-align:right;">
42
</td>
<td style="text-align:right;">
32
</td>
<td style="text-align:right;">
25
</td>
<td style="text-align:right;">
45
</td>
<td style="text-align:right;">
30
</td>
<td style="text-align:right;">
37
</td>
<td style="text-align:right;">
22
</td>
<td style="text-align:right;">
31
</td>
<td style="text-align:right;">
29
</td>
<td style="text-align:right;">
39
</td>
<td style="text-align:right;">
44
</td>
<td style="text-align:right;">
21
</td>
</tr>
</tbody>
</table>

    `summarise()` has grouped output by 'site_name'. You can override using the `.groups` argument.

    Warning: `funs()` was deprecated in dplyr 0.8.0.
    Please use a list of either functions or lambdas: 

      # Simple named list: 
      list(mean = mean, median = median)

      # Auto named with `tibble::lst()`: 
      tibble::lst(mean, median)

      # Using lambdas
      list(~ mean(., trim = .2), ~ median(., na.rm = TRUE))

<table class=" lightable-classic" style="font-family: serif; margin-left: auto; margin-right: auto;">
<caption>
percent-nondetects summary
</caption>
<thead>
<tr>
<th style="text-align:left;">
parameter
</th>
<th style="text-align:left;">
king-COM
</th>
<th style="text-align:left;">
king-HDR
</th>
<th style="text-align:left;">
king-LDR
</th>
<th style="text-align:left;">
pos-COM
</th>
<th style="text-align:left;">
pot-COM
</th>
<th style="text-align:left;">
sea-COM
</th>
<th style="text-align:left;">
sea-HDR
</th>
<th style="text-align:left;">
sea-IND
</th>
<th style="text-align:left;">
sno-COM
</th>
<th style="text-align:left;">
sno-HDR
</th>
<th style="text-align:left;">
sno-LDR
</th>
<th style="text-align:left;">
tac-COM
</th>
<th style="text-align:left;">
tac-HDR
</th>
<th style="text-align:left;">
tac-IND
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Chloride.Total
</td>
<td style="text-align:left;">
0%
</td>
<td style="text-align:left;">
0%
</td>
<td style="text-align:left;">
0%
</td>
<td style="text-align:left;">
0%
</td>
<td style="text-align:left;">
0%
</td>
<td style="text-align:left;">
0%
</td>
<td style="text-align:left;">
0%
</td>
<td style="text-align:left;">
0%
</td>
<td style="text-align:left;">
5%
</td>
<td style="text-align:left;">
22%
</td>
<td style="text-align:left;">
2%
</td>
<td style="text-align:left;">
0%
</td>
<td style="text-align:left;">
0%
</td>
<td style="text-align:left;">
0%
</td>
</tr>
<tr>
<td style="text-align:left;">
Conductivity.Total
</td>
<td style="text-align:left;">
0%
</td>
<td style="text-align:left;">
0%
</td>
<td style="text-align:left;">
0%
</td>
<td style="text-align:left;">
0%
</td>
<td style="text-align:left;">
3%
</td>
<td style="text-align:left;">
0%
</td>
<td style="text-align:left;">
0%
</td>
<td style="text-align:left;">
0%
</td>
<td style="text-align:left;">
NA%
</td>
<td style="text-align:left;">
0%
</td>
<td style="text-align:left;">
0%
</td>
<td style="text-align:left;">
0%
</td>
<td style="text-align:left;">
0%
</td>
<td style="text-align:left;">
0%
</td>
</tr>
<tr>
<td style="text-align:left;">
Nitrite-Nitrate.Dissolved
</td>
<td style="text-align:left;">
0%
</td>
<td style="text-align:left;">
0%
</td>
<td style="text-align:left;">
0%
</td>
<td style="text-align:left;">
51%
</td>
<td style="text-align:left;">
3%
</td>
<td style="text-align:left;">
0%
</td>
<td style="text-align:left;">
0%
</td>
<td style="text-align:left;">
0%
</td>
<td style="text-align:left;">
NA%
</td>
<td style="text-align:left;">
NA%
</td>
<td style="text-align:left;">
NA%
</td>
<td style="text-align:left;">
0%
</td>
<td style="text-align:left;">
0%
</td>
<td style="text-align:left;">
0%
</td>
</tr>
<tr>
<td style="text-align:left;">
Ortho-phosphate.Dissolved
</td>
<td style="text-align:left;">
3%
</td>
<td style="text-align:left;">
0%
</td>
<td style="text-align:left;">
0%
</td>
<td style="text-align:left;">
14%
</td>
<td style="text-align:left;">
10%
</td>
<td style="text-align:left;">
3%
</td>
<td style="text-align:left;">
0%
</td>
<td style="text-align:left;">
0%
</td>
<td style="text-align:left;">
26%
</td>
<td style="text-align:left;">
41%
</td>
<td style="text-align:left;">
4%
</td>
<td style="text-align:left;">
4%
</td>
<td style="text-align:left;">
5%
</td>
<td style="text-align:left;">
14%
</td>
</tr>
<tr>
<td style="text-align:left;">
Total Kjeldahl Nitrogen.Total
</td>
<td style="text-align:left;">
0%
</td>
<td style="text-align:left;">
0%
</td>
<td style="text-align:left;">
3%
</td>
<td style="text-align:left;">
17%
</td>
<td style="text-align:left;">
57%
</td>
<td style="text-align:left;">
0%
</td>
<td style="text-align:left;">
0%
</td>
<td style="text-align:left;">
0%
</td>
<td style="text-align:left;">
6%
</td>
<td style="text-align:left;">
18%
</td>
<td style="text-align:left;">
14%
</td>
<td style="text-align:left;">
4%
</td>
<td style="text-align:left;">
2%
</td>
<td style="text-align:left;">
5%
</td>
</tr>
<tr>
<td style="text-align:left;">
Total Phosphorus.Total
</td>
<td style="text-align:left;">
0%
</td>
<td style="text-align:left;">
0%
</td>
<td style="text-align:left;">
0%
</td>
<td style="text-align:left;">
15%
</td>
<td style="text-align:left;">
14%
</td>
<td style="text-align:left;">
0%
</td>
<td style="text-align:left;">
0%
</td>
<td style="text-align:left;">
0%
</td>
<td style="text-align:left;">
NA%
</td>
<td style="text-align:left;">
0%
</td>
<td style="text-align:left;">
NA%
</td>
<td style="text-align:left;">
0%
</td>
<td style="text-align:left;">
7%
</td>
<td style="text-align:left;">
5%
</td>
</tr>
<tr>
<td style="text-align:left;">
Total Suspended Solids.Total
</td>
<td style="text-align:left;">
0%
</td>
<td style="text-align:left;">
0%
</td>
<td style="text-align:left;">
7%
</td>
<td style="text-align:left;">
0%
</td>
<td style="text-align:left;">
0%
</td>
<td style="text-align:left;">
0%
</td>
<td style="text-align:left;">
0%
</td>
<td style="text-align:left;">
0%
</td>
<td style="text-align:left;">
NA%
</td>
<td style="text-align:left;">
NA%
</td>
<td style="text-align:left;">
NA%
</td>
<td style="text-align:left;">
0%
</td>
<td style="text-align:left;">
0%
</td>
<td style="text-align:left;">
0%
</td>
</tr>
<tr>
<td style="text-align:left;">
Hardness as CaCO3.Total
</td>
<td style="text-align:left;">
NA%
</td>
<td style="text-align:left;">
NA%
</td>
<td style="text-align:left;">
NA%
</td>
<td style="text-align:left;">
0%
</td>
<td style="text-align:left;">
NA%
</td>
<td style="text-align:left;">
0%
</td>
<td style="text-align:left;">
0%
</td>
<td style="text-align:left;">
0%
</td>
<td style="text-align:left;">
0%
</td>
<td style="text-align:left;">
0%
</td>
<td style="text-align:left;">
0%
</td>
<td style="text-align:left;">
0%
</td>
<td style="text-align:left;">
0%
</td>
<td style="text-align:left;">
0%
</td>
</tr>
</tbody>
</table>

![](nutrients_clusters_files/figure-gfm/unnamed-chunk-2-1.png)<!-- -->

<!-- ## All sites  -->
<!-- ```{r fig.height=8, fig.width=8} -->
<!-- all.sites <-  -->
<!-- s8.data.df %>%  -->
<!--   mutate(loc_date = paste0(site_name, "_",field_collection_start_date)) %>% -->
<!--   pivot_wider( -->
<!--     names_from = loc_date, id_cols = parameter, -->
<!--     values_from = new_result_value, -->
<!--     values_fn = mean -->
<!--   ) %>% -->
<!--   remove_rownames() %>% -->
<!--   column_to_rownames("parameter") %>% -->
<!--   log() %>%  -->
<!--   t() %>% -->
<!--   as.data.frame() %>% -->
<!--   drop_na() %>% -->
<!--   scale(center = TRUE, scale = TRUE) %>%  -->
<!--   t() %>% -->
<!--   as.data.frame()  -->
<!-- all.sites.t <- all.sites %>% t() %>% as.data.frame() %>% pivot_longer(cols = everything()) -->
<!-- km <- kmeans(all.sites, 3) -->
<!-- km$cluster %>% as.data.frame() -->
<!-- all.sites.t %>% left_join(km$cluster %>% as.data.frame()) -->
<!-- #fviz_nbclust(all.sites, kmeans, k.max =9) -->
<!-- ggpairs(all.sites %>% t(), col=c(1:4)[km$cluster]) -->
<!-- fviz_cluster(main = "All Sites", kmeans(all.sites, 4),data = all.sites,repel =TRUE,show.clust.cent = FALSE,ellipse.type = "confidence", ellipse.level = 0.9) -->
<!-- ``` -->

![](nutrients_clusters_files/figure-gfm/unnamed-chunk-4-1.png)<!-- -->

    $plot1
    NULL

    $plot2

![](nutrients_clusters_files/figure-gfm/unnamed-chunk-4-2.png)<!-- -->
![](nutrients_clusters_files/figure-gfm/unnamed-chunk-4-3.png)<!-- -->

    $plot1
    NULL

    $plot2

    Warning: Computation failed in `stat_conf_ellipse()`:
    missing value where TRUE/FALSE needed

![](nutrients_clusters_files/figure-gfm/unnamed-chunk-4-4.png)<!-- -->
![](nutrients_clusters_files/figure-gfm/unnamed-chunk-4-5.png)<!-- -->

    $plot1
    NULL

    $plot2

    Warning: Computation failed in `stat_conf_ellipse()`:
    missing value where TRUE/FALSE needed

![](nutrients_clusters_files/figure-gfm/unnamed-chunk-4-6.png)<!-- -->
![](nutrients_clusters_files/figure-gfm/unnamed-chunk-4-7.png)<!-- -->

    $plot1
    NULL

    $plot2

    Warning: Computation failed in `stat_conf_ellipse()`:
    missing value where TRUE/FALSE needed

![](nutrients_clusters_files/figure-gfm/unnamed-chunk-4-8.png)<!-- -->
![](nutrients_clusters_files/figure-gfm/unnamed-chunk-4-9.png)<!-- -->

    $plot1
    NULL

    $plot2

    Warning: Computation failed in `stat_conf_ellipse()`:
    missing value where TRUE/FALSE needed

![](nutrients_clusters_files/figure-gfm/unnamed-chunk-4-10.png)<!-- -->
![](nutrients_clusters_files/figure-gfm/unnamed-chunk-4-11.png)<!-- -->

    $plot1
    NULL

    $plot2

![](nutrients_clusters_files/figure-gfm/unnamed-chunk-4-12.png)<!-- -->
![](nutrients_clusters_files/figure-gfm/unnamed-chunk-4-13.png)<!-- -->

    $plot1
    NULL

    $plot2

![](nutrients_clusters_files/figure-gfm/unnamed-chunk-4-14.png)<!-- -->
![](nutrients_clusters_files/figure-gfm/unnamed-chunk-4-15.png)<!-- -->

    $plot1
    NULL

    $plot2

![](nutrients_clusters_files/figure-gfm/unnamed-chunk-4-16.png)<!-- -->
![](nutrients_clusters_files/figure-gfm/unnamed-chunk-4-17.png)<!-- -->

    $plot1
    NULL

    $plot2

![](nutrients_clusters_files/figure-gfm/unnamed-chunk-4-18.png)<!-- -->
![](nutrients_clusters_files/figure-gfm/unnamed-chunk-4-19.png)<!-- -->

    $plot1
    NULL

    $plot2

    Warning: Computation failed in `stat_conf_ellipse()`:
    missing value where TRUE/FALSE needed

![](nutrients_clusters_files/figure-gfm/unnamed-chunk-4-20.png)<!-- -->


    Error in sample.int(m, k) : 
      cannot take a sample larger than the population when 'replace = FALSE'

![](nutrients_clusters_files/figure-gfm/unnamed-chunk-4-21.png)<!-- -->

    $plot1
    NULL

    $plot2

    Warning: Computation failed in `stat_conf_ellipse()`:
    missing value where TRUE/FALSE needed

![](nutrients_clusters_files/figure-gfm/unnamed-chunk-4-22.png)<!-- -->
![](nutrients_clusters_files/figure-gfm/unnamed-chunk-4-23.png)<!-- -->

    $plot1
    NULL

    $plot2

    Warning: Computation failed in `stat_conf_ellipse()`:
    missing value where TRUE/FALSE needed

![](nutrients_clusters_files/figure-gfm/unnamed-chunk-4-24.png)<!-- -->
![](nutrients_clusters_files/figure-gfm/unnamed-chunk-4-25.png)<!-- -->

    $plot1
    NULL

    $plot2

    Warning: Computation failed in `stat_conf_ellipse()`:
    missing value where TRUE/FALSE needed

![](nutrients_clusters_files/figure-gfm/unnamed-chunk-4-26.png)<!-- -->
